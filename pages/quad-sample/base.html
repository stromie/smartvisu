/**
 * -----------------------------------------------------------------------------
 * @package     smartVISU
 * @author      Martin Gleiß
 * @copyright   2012
 * @license     GPL <http://www.gnu.de>
 * ----------------------------------------------------------------------------- 
 */
<!DOCTYPE html> 



<html>
<head>
	<title>{{ config_title }}</title>

	<meta charset="utf-8" />
	<meta http-equiv="expires" content="0" />

	<meta name="viewport" content="width=device-width, user-scalable=yes, initial-scale=1, maximum-scale=1.3, minimum-scale=1" />
	<meta name="apple-mobile-web-app-capable" content="yes" />
	<meta name="apple-mobile-web-app-status-bar-style" content="black" />

	<link rel="icon" href="favicon.png" />
	<link rel="icon" href="favicon.ico" type="image/x-icon" />
	<link rel="apple-touch-icon" href="favicon.png" />
	
	<link rel="stylesheet" href="vendor/jquery.mobile/jquery.mobile.structure-1.4.5.min.css" />

/** CSS assets **/
{% set cssFiles = [
		'designs/' ~ config_design ~ '.css', 
		icon0 ~ 'jquery.mobile.icons.min.css', 
		'pages/base/base.css', 
		'pages/' ~config_pages ~ '/visu.css'
	] %}
{%- if config_cache %} /** only use minified and merged version if page cache is activated. otherwise use original single files. **/
	<link rel="stylesheet" href="assets.php?type=css
	{%- for cssFile in cssFiles -%}
		{%- if cssFile is not empty and isfile(cssFile) -%}
			&amp;{{- 'files[]'|url_encode -}}={{- cssFile|url_encode -}}
		{%- endif -%}
	{%- endfor -%}
	" />
{% else -%}
	{%- for cssFile in cssFiles -%}
		{%- if cssFile is not empty and isfile(cssFile) %}

	<link rel="stylesheet" href="{{ cssFile }}" />
		{%- endif -%}
	{%- endfor %}
{% endif %}

<script>
console.log = function() {};
</script>
	<script type="text/javascript" src="vendor/jquery/jquery-2.1.4.min.js"></script>

{%- if config_transition != 'fade' %}
	<script type="text/javascript">
		$(document).on("mobileinit", function () {
			$.mobile.defaultPageTransition = '{{ config_transition }}';
		});
	</script>
{% endif %}

	<script type="text/javascript">
		// work around a bug of jQuery Mobile 1.4.5 themes
		$(document).on("pagebeforecreate", function( event, ui ) {
			$(this).find('div[data-role="collapsible-set"][data-theme]').each(function() {
				$(this).find('div[data-role="collapsible"]:not([data-theme])').attr('data-theme', $(this).attr('data-theme'));
				$(this).attr('data-theme','');
			});
			$(this).find('ul[data-role="listview"][data-dividertheme]').each(function() {
				$(this).find('li[data-role="list-divider"]:not([data-theme])').attr('data-theme', $(this).attr('data-dividertheme'));
			});
		});
	</script>

	<script type="text/javascript" src="vendor/jquery.mobile/jquery.mobile-1.4.5.min.js"></script>
	
/** JavaScript assets **/
{% set jsFiles = [
		'lib/base/jquery.mobile.slider.js', 
		'vendor/plot.highcharts/highcharts.js', 
		'designs/' ~ config_design ~ '.js', 
		'widgets/widget.js', 
		config_animation ? 'widgets/animation.js' : null,
		'lib/base/base.js', 
		'lib/base/base.php', 
		'driver/io_' ~ config_driver ~ '.js', 
		'pages/' ~ config_pages ~ '/visu.js' 
	] %}
{%- if config_cache -%} /** only use minified and merged version if page cache is activated. otherwise use original single files. **/
	<script type="text/javascript" src="assets.php?type=js
	{%- for jsFile in jsFiles -%}
		{%- if jsFile is not empty and isfile(jsFile) -%}
			&amp;{{- 'files[]'|url_encode -}}={{- jsFile|url_encode -}}
		{%- endif -%}
	{%- endfor -%}
	"></script>
{%- else -%}
	{%- for jsFile in jsFiles -%}
		{%- if jsFile is not empty and isfile(jsFile) %}

	<script type="text/javascript" src="{{ jsFile }}"></script>
		{%- endif -%}
	{%- endfor -%}
{% endif %}


{% block head %}{% endblock %}

{% import "lib.html" as lib %}
{% import "basic.html" as basic %}
{% import "device.html" as device %}
{% import "plot.html" as plot %}
{% import "clock.html" as clock %}
</head>


<body>

<script type="text/javascript">
	io.init('{{ config_driver_address }}', '{{ config_driver_port }}');
{% if config_driver_autoreconnect %}
	activateAutoReconnect();
{% endif %}

	// Do some actions before page is shown
	$(document).on('pagebeforeshow', function () {
		fx.init();
		repeater.init();
		widget.prepare();
		// repeater.list();
	});

	// Run the io and all widgets
	$(document).on('pageshow', function () {
		io.run({{ config_driver_realtime }});
		// console.log('[io] run');       	
		notify.display();
		// widget.list();
	});

	$.mobile.page.prototype.options.domCache = {{ (config_cache_dom ? 'true' : 'false') }};
</script>

{% block body %}{% endblock %}

<div data-role="page" id="{{ page }}" data-theme="a">

    {% block page %}
	<div data-role="header" data-position="fixed" data-tap-toggle="false">
        <h1>
            {% block title %}{% endblock %}
        </h1>
        <div class="ui-left">
            {% include 'menu.html' %}
        </div>
        <div class="ui-right">
            {% block header %}{% endblock %}
        </div>
		<div class="signal hide" onClick="$('.ui-page-active .alert').popup('open');"></div>
		<div class="alert" data-role="popup" data-overlay-theme="a">
		    <div data-role="header" data-theme="c"><h1></h1></div><p></p>
			<div class="control">
				<span class="stamp"></span>
		    	<a onClick="notify.remove();" class="ui-mini" data-icon="check" data-iconpos="top" data-role="button" data-inline="true">OK</a>
				<a onClick="$('.alert').popup('close');" class="ui-mini" class="ui-mini" data-icon="delete" data-iconpos="top" data-role="button" data-inline="true">Cancel</a>
		    </div>

		</div>
    </div>
    
    <div data-role="content" class="page-bg">
        {% block content_all %}
		<div class="content-primary">
            {% block content %}
            <div class="nw_quad">
                {% block quad_main_top %}{% endblock %}
            </div>
            <div class="nw_quad nw_min_tablet">
                {% block quad_main_bottom %}{% endblock %}
            </div>
            {% endblock %}
        </div>
        
        <div class="content-secondary"> 
            {% block sidebar %}
            <div class="nw_quad">
                {% block quad_top %}{% endblock %}
            </div>
            <div class="nw_quad">
                {% block quad_bottom %}{% endblock %}
            </div>
            {% endblock %}
        </div>
        {% endblock %}
    </div>

	{% block footer %}{% endblock %}

    {% endblock %}

<div data-role="popup" class="popupUZSU ui-content nw_popup-uzsu"  data-dismissible="false" data-position-to="window">
    <div class="panel_list">
        <div class="content">
            <ul class="uzsu-items touch" data-role="listview">
            </ul>
        </div>
        <div class="add"><span>ADD</span></div>
        <div><span><a data-role="button" class="activate" data-icon="check" data-iconpos="notext"></a></span></div> 
        <div class="right ok"><span>OK</span></div>
        <div class="right close"><span>ESC</span></div>
    </div>    
    
    <div class="panel_date_type">
        <div class="content">
            <ul class="list_date_type touch" data-role="listview">
                <li>Täglich</li>
                <li>Werktage</li>
                <li>Wochenende</li>
            </ul>
        </div>
        <div class="right"><span>&nbsp;</span></div>
        <div class="right prev"><span>ESC</span></div>
    </div> 
    
    <div class="panel_time_type">
        <div class="content">
            <ul class="list_time_type touch" data-role="listview">
                <li>Uhrzeit</li>
            </ul>
        </div>
        <div class="right"><span>&nbsp;</span></div>
        <div class="right prev"><span>ESC</span></div>
    </div>
    
    <div class="panel_value_bool" style="display:none;">
        <div class="content">
            <select data-role="slider">
                <option value="0">Off</option>
                <option value="1">On</option>
            </select> 
        </div>
        <div class="right next"><span>OK</span></div>
        <div class="right prev"><span>ESC</span></div>
    </div>
    
    <div class="panel_value_percent" style="display:none;">
        <div class="numpad_value"><span></span></div>
        <div class="number_button"><span>1</span></div>
        <div class="number_button"><span>2</span></div>
        <div class="number_button"><span>3</span></div>
        <div class="number_button"><span>4</span></div>
        <div class="number_button"><span>5</span></div>
        <div class="number_button"><span>6</span></div>
        <div class="number_button"><span>7</span></div>
        <div class="number_button"><span>8</span></div>
        <div class="number_button"><span>9</span></div>
        <div class="number_button"><span>AC</span></div>
        <div class="number_button"><span>0</span></div>
        <div class="number_button"><span>C</span></div>
        <div class="right next"><span>OK</span></div>
        <div class="right prev"><span>ESC</span></div>
    </div>
    
    <div class="panel_time" style="display:none;" data-value="">
        <div class="numpad_value"><span>__:__ Uhr</span></div>
        <div class="number_button"><span>1</span></div>
        <div class="number_button"><span>2</span></div>
        <div class="number_button"><span>3</span></div>
        <div class="number_button"><span>4</span></div>
        <div class="number_button"><span>5</span></div>
        <div class="number_button"><span>6</span></div>
        <div class="number_button"><span>7</span></div>
        <div class="number_button"><span>8</span></div>
        <div class="number_button"><span>9</span></div>
        <div class="number_button"><span>AC</span></div>
        <div class="number_button"><span>0</span></div>
        <div class="number_button"><span>C</span></div>
        <div class="right next"><span>OK</span></div>
        <div class="right prev"><span>ESC</span></div>
    </div>
</div>



</div>

</body>
</html>
